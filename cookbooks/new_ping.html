<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Sending a Custom Ping - Firefox Data Documentation</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../dtmo.css">
        
        <link rel="stylesheet" href="../mermaid.css">
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="affix"><a href="../introduction.html">Firefox Data Documentation</a></li><li><a href="../concepts/reporting_a_problem.html"><strong aria-hidden="true">1.</strong> Reporting a problem</a></li><li><a href="../concepts/terminology.html"><strong aria-hidden="true">2.</strong> Terminology</a></li><li><a href="../concepts/getting_started.html"><strong aria-hidden="true">3.</strong> Getting Started</a></li><li><ol class="section"><li><a href="../concepts/analysis_intro.html"><strong aria-hidden="true">3.1.</strong> Analysis Quick Start</a></li><li><a href="../concepts/choosing_a_dataset.html"><strong aria-hidden="true">3.2.</strong> Choosing a Dataset</a></li><li><a href="../concepts/choosing_a_dataset_mobile.html"><strong aria-hidden="true">3.3.</strong> Choosing a Dataset - Mobile Edition</a></li><li><a href="../tools/stmo.html"><strong aria-hidden="true">3.4.</strong> Intro to STMO</a></li><li><a href="../concepts/analysis_gotchas.html"><strong aria-hidden="true">3.5.</strong> Common Analysis Gotchas</a></li><li><a href="../concepts/sql_optimization.html"><strong aria-hidden="true">3.6.</strong> Optimizing Queries</a></li><li><a href="../datasets/new_data.html"><strong aria-hidden="true">3.7.</strong> Collecting New Data</a></li><li><a href="../concepts/getting_help.html"><strong aria-hidden="true">3.8.</strong> Getting Help</a></li></ol></li><li><a href="../tools/index.html"><strong aria-hidden="true">4.</strong> Tools</a></li><li><ol class="section"><li><a href="../tools/projects.html"><strong aria-hidden="true">4.1.</strong> Project Glossary</a></li><li><a href="../concepts/pipeline/data_pipeline.html"><strong aria-hidden="true">4.2.</strong> Overview of Mozilla's Data Pipeline</a></li><li><ol class="section"><li><a href="../concepts/pipeline/data_pipeline_detail.html"><strong aria-hidden="true">4.2.1.</strong> In-depth Data Pipeline Detail</a></li><li><a href="../concepts/pipeline/http_edge_spec.html"><strong aria-hidden="true">4.2.2.</strong> HTTP Edge Server Specification</a></li><li><a href="../concepts/pipeline/event_pipeline.html"><strong aria-hidden="true">4.2.3.</strong> Event Pipeline Detail</a></li></ol></li><li><a href="../tools/interfaces.html"><strong aria-hidden="true">4.3.</strong> Analysis Interfaces</a></li><li><a href="../tools/spark.html"><strong aria-hidden="true">4.4.</strong> Custom analysis with Spark</a></li><li><a href="../concepts/sql_style.html"><strong aria-hidden="true">4.5.</strong> SQL Style Guide</a></li><li><a href="../concepts/glean/glean.html"><strong aria-hidden="true">4.6.</strong> Glean overview</a></li><li><ol class="section"><li><a href="../concepts/glean/debug_ping_view.html"><strong aria-hidden="true">4.6.1.</strong> Glean Debug ping viewer</a></li></ol></li></ol></li><li><a href="../cookbooks/index.html"><strong aria-hidden="true">5.</strong> Cookbooks</a></li><li><ol class="section"><li><a href="../tools/alerts.html"><strong aria-hidden="true">5.1.</strong> Alerts</a></li><li><a href="../cookbooks/bigquery.html"><strong aria-hidden="true">5.2.</strong> Accessing and working with BigQuery</a></li><li><a href="../cookbooks/new_ping.html" class="active"><strong aria-hidden="true">5.3.</strong> Sending a Custom Ping</a></li><li><a href="../cookbooks/client_guidelines.html"><strong aria-hidden="true">5.4.</strong> Client Implementation Guidelines</a></li><li><a href="../cookbooks/dataset_specific.html"><strong aria-hidden="true">5.5.</strong> Dataset Specific</a></li><li><ol class="section"><li><a href="../cookbooks/longitudinal_examples.html"><strong aria-hidden="true">5.5.1.</strong> Longitudinal Examples</a></li><li><a href="../cookbooks/crash_pings.html"><strong aria-hidden="true">5.5.2.</strong> Working with Crash Pings</a></li><li><a href="../cookbooks/normandy_events.html"><strong aria-hidden="true">5.5.3.</strong> Working with Normandy events</a></li></ol></li><li><a href="../cookbooks/realtime.html"><strong aria-hidden="true">5.6.</strong> Real-time</a></li><li><ol class="section"><li><a href="../cookbooks/realtime_analysis_plugin.html"><strong aria-hidden="true">5.6.1.</strong> Creating a Real-time Analysis Plugin</a></li><li><a href="../cookbooks/view_pings_cep.html"><strong aria-hidden="true">5.6.2.</strong> Seeing Your Own Pings</a></li><li><a href="../tools/cep_matcher.html"><strong aria-hidden="true">5.6.3.</strong> CEP Matcher</a></li></ol></li><li><a href="../cookbooks/metrics.html"><strong aria-hidden="true">5.7.</strong> Metrics</a></li><li><ol class="section"><li><a href="../cookbooks/dau.html"><strong aria-hidden="true">5.7.1.</strong> Daily Active Users (DAU)</a></li><li><a href="../cookbooks/active_dau.html"><strong aria-hidden="true">5.7.2.</strong> Active DAU (aDAU)</a></li><li><a href="../cookbooks/retention.html"><strong aria-hidden="true">5.7.3.</strong> Retention</a></li></ol></li><li><a href="../cookbooks/events_best_practices.html"><strong aria-hidden="true">5.8.</strong> Telemetry Events Best Practices</a></li><li class="spacer"></li></ol></li><li><a href="../datasets/reference.html"><strong aria-hidden="true">6.</strong> Dataset Reference</a></li><li><ol class="section"><li><a href="../datasets/pings.html"><strong aria-hidden="true">6.1.</strong> Pings</a></li><li><a href="../datasets/derived.html"><strong aria-hidden="true">6.2.</strong> Derived Datasets</a></li><li><ol class="section"><li><a href="../datasets/batch_view/addons/reference.html"><strong aria-hidden="true">6.2.1.</strong> Addons</a></li><li><a href="../datasets/other/addons_daily/reference.html"><strong aria-hidden="true">6.2.2.</strong> Addons Daily</a></li><li><a href="../datasets/batch_view/clients_daily/reference.html"><strong aria-hidden="true">6.2.3.</strong> Clients Daily</a></li><li><a href="../datasets/bigquery/clients_last_seen/reference.html"><strong aria-hidden="true">6.2.4.</strong> Clients Last Seen</a></li><li><a href="../datasets/batch_view/crash_summary/reference.html"><strong aria-hidden="true">6.2.5.</strong> Crash Summary</a></li><li><a href="../datasets/batch_view/cross_sectional/reference.html"><strong aria-hidden="true">6.2.6.</strong> Cross Sectional</a></li><li><a href="../datasets/streaming/error_aggregates/reference.html"><strong aria-hidden="true">6.2.7.</strong> Error Aggregates</a></li><li><a href="../datasets/batch_view/events/reference.html"><strong aria-hidden="true">6.2.8.</strong> Events</a></li><li><a href="../datasets/bigquery/exact_mau/reference.html"><strong aria-hidden="true">6.2.9.</strong> Exact MAU</a></li><li><a href="../datasets/batch_view/first_shutdown_summary/reference.html"><strong aria-hidden="true">6.2.10.</strong> First Shutdown Summary</a></li><li><a href="../datasets/batch_view/longitudinal/reference.html"><strong aria-hidden="true">6.2.11.</strong> Longitudinal</a></li><li><a href="../datasets/batch_view/main_summary/reference.html"><strong aria-hidden="true">6.2.12.</strong> Main Summary</a></li><li><a href="../datasets/batch_view/new_profile/reference.html"><strong aria-hidden="true">6.2.13.</strong> New Profile</a></li><li><a href="../datasets/other/socorro_crash/reference.html"><strong aria-hidden="true">6.2.14.</strong> Socorro Crash Reports</a></li><li><a href="../datasets/other/ssl/reference.html"><strong aria-hidden="true">6.2.15.</strong> SSL Ratios (public)</a></li><li><a href="../datasets/batch_view/sync_summary/reference.html"><strong aria-hidden="true">6.2.16.</strong> Sync Summary</a></li><li><a href="../datasets/batch_view/update/reference.html"><strong aria-hidden="true">6.2.17.</strong> Update</a></li></ol></li><li><a href="../tools/experiments.html"><strong aria-hidden="true">6.3.</strong> Experimental Datasets</a></li><li><ol class="section"><li><a href="../datasets/heartbeat.html"><strong aria-hidden="true">6.3.1.</strong> Accessing Heartbeat data</a></li><li><a href="../datasets/shield.html"><strong aria-hidden="true">6.3.2.</strong> Accessing Shield Study data</a></li></ol></li><li><a href="../datasets/search.html"><strong aria-hidden="true">6.4.</strong> Search Datasets</a></li><li><ol class="section"><li><a href="../datasets/mozetl/search_aggregates/reference.html"><strong aria-hidden="true">6.4.1.</strong> Search Aggregates</a></li><li><a href="../datasets/mozetl/search_clients_daily/reference.html"><strong aria-hidden="true">6.4.2.</strong> Search Clients Daily</a></li></ol></li><li><a href="../datasets/other.html"><strong aria-hidden="true">6.5.</strong> Other Datasets</a></li><li><ol class="section"><li><a href="../datasets/other/hgpush/reference.html"><strong aria-hidden="true">6.5.1.</strong> hgpush</a></li><li><a href="../datasets/other/stub_installer/reference.html"><strong aria-hidden="true">6.5.2.</strong> Stub installer ping</a></li></ol></li><li><a href="../datasets/obsolete.html"><strong aria-hidden="true">6.6.</strong> Obsolete Datasets</a></li><li><ol class="section"><li><a href="../datasets/obsolete/heavy_users/reference.html"><strong aria-hidden="true">6.6.1.</strong> Heavy Users</a></li><li><a href="../datasets/obsolete/crash_aggregates/reference.html"><strong aria-hidden="true">6.6.2.</strong> Crash Aggregates</a></li><li><a href="../datasets/obsolete/client_count/reference.html"><strong aria-hidden="true">6.6.3.</strong> Client Count</a></li><li><a href="../datasets/obsolete/client_count_daily/reference.html"><strong aria-hidden="true">6.6.4.</strong> Client Count Daily</a></li><li><a href="../datasets/obsolete/retention/reference.html"><strong aria-hidden="true">6.6.5.</strong> Retention</a></li><li><a href="../datasets/obsolete/churn/reference.html"><strong aria-hidden="true">6.6.6.</strong> Churn</a></li></ol></li><li><a href="../datasets/fxa.html"><strong aria-hidden="true">6.7.</strong> Firefox Accounts Datasets</a></li><li><ol class="section"><li><a href="../datasets/fxa_metrics/attribution.html"><strong aria-hidden="true">6.7.1.</strong> Firefox Account Attribution</a></li><li><a href="../datasets/fxa_metrics/funnels.html"><strong aria-hidden="true">6.7.2.</strong> Firefox Account Funnel Metrics</a></li><li><a href="../datasets/fxa_metrics/emails.html"><strong aria-hidden="true">6.7.3.</strong> Firefox Account Email Metrics</a></li><li class="spacer"></li></ol></li></ol></li><li><a href="../concepts/index.html"><strong aria-hidden="true">7.</strong> Telemetry Behavior Reference</a></li><li><ol class="section"><li><a href="../concepts/profile/index.html"><strong aria-hidden="true">7.1.</strong> Profile Behavior</a></li><li><ol class="section"><li><a href="../concepts/profile/profile_creation.html"><strong aria-hidden="true">7.1.1.</strong> Profile Creation</a></li><li><a href="../concepts/profile/realworldusage.html"><strong aria-hidden="true">7.1.2.</strong> Real World Usage</a></li><li><a href="../concepts/profile/profilehistory.html"><strong aria-hidden="true">7.1.3.</strong> Profile History</a></li></ol></li><li><a href="../concepts/channels/index.html"><strong aria-hidden="true">7.2.</strong> Channel Behavior</a></li><li><ol class="section"><li><a href="../concepts/channels/channel_normalization.html"><strong aria-hidden="true">7.2.1.</strong> Channel Normalization and Querying</a></li><li class="spacer"></li></ol></li></ol></li><li><a href="../meta/index.html"><strong aria-hidden="true">8.</strong> About this Documentation</a></li><li><ol class="section"><li><a href="../meta/contributing.html"><strong aria-hidden="true">8.1.</strong> Contributing</a></li><li><a href="../meta/structure.html"><strong aria-hidden="true">8.2.</strong> Structure</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Firefox Data Documentation</h1>

                        <div class="right-buttons">
                            <a href="../print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#sending-a-custom-ping" id="sending-a-custom-ping">Sending a Custom Ping</a></h1>
<p>Got some new data you want to send to us? How in the world do you send a new ping? Follow this guide
to find out.</p>
<h2><a class="header" href="#write-your-questions" id="write-your-questions">Write Your Questions</a></h2>
<p>Do not try and implement new pings unless you know specifically what questions you're trying to
answer. General questions about &quot;How do users use our product?&quot; won't cut it - these need to be
specific, concrete asks that can be translated to data points. This will also make it easier down
the line as you start data review.</p>
<p>More detail on how to design and implement new pings for Firefox Desktop <a href="https://firefox-source-docs.mozilla.org/toolkit/components/telemetry/telemetry/collection/custom-pings.html">can be found here</a>.</p>
<h2><a class="header" href="#choose-a-namespace-and-doctype" id="choose-a-namespace-and-doctype">Choose a Namespace and DocType</a></h2>
<p>For new telemetry pings, the namespace is simply <code>telemetry</code>. For non-Telemetry
pings, choose a namespace that uniquely identifies the product that will be
generating the data.</p>
<p>The DocType is used to differentiate pings within a namespace. It can be as
simple as <code>event</code>, but should generally be descriptive of the data being
collected.</p>
<p>Both namespace and DocType are limited to the pattern <code>[a-zA-Z-]</code>. In other words, hyphens and letters from the <a href="https://en.wikipedia.org/wiki/ISO_basic_Latin_alphabet">ISO basic Latin alphabet</a>.</p>
<h2><a class="header" href="#create-a-schema" id="create-a-schema">Create a Schema</a></h2>
<p>Use JSON Schema to start with. See the <a href="https://github.com/mozilla-services/mozilla-pipeline-schemas#adding-a-new-schema">&quot;Adding a new schema&quot; documentation</a> and examples schemas in the
<a href="https://github.com/mozilla-services/mozilla-pipeline-schemas/">Mozilla Pipeline Schemas repo</a>.
This schema is just used to validate the incoming data; any ping that doesn't match the schema
will be removed. Validate your JSON Schema using a
<a href="https://jsonschemalint.com/#/version/draft-04/markup/json">validation tool</a>.</p>
<p>We already have automatic deduplicating based on <code>docId</code>, which catches about 90% of duplicates and
removes them from the dataset.</p>
<h2><a class="header" href="#start-a-data-review" id="start-a-data-review">Start a Data Review</a></h2>
<p>Data review for new pings is more complicated than when adding new probes. See
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1347266">Data Review for Focus-Event Ping</a>
as an example. Consider where the data falls in the
<a href="https://wiki.mozilla.org/Firefox/Data_Collection">Data Collection Categories</a>.</p>
<h2><a class="header" href="#submit-schema-to-mozilla-servicesmozilla-pipeline-schemas" id="submit-schema-to-mozilla-servicesmozilla-pipeline-schemas">Submit Schema to <code>mozilla-services/mozilla-pipeline-schemas</code></a></h2>
<p>The first schema added should be the JSON Schema made in step 2.
Add at least one example ping which the data can be validated against.
These test pings will be validated automatically during the build.</p>
<p>Additionally,
a <a href="https://github.com/mozilla-services/mozilla-pipeline-schemas/blob/master/schemas/telemetry/core/core.9.parquetmr.txt">Parquet output</a>
schema should be added. This would add a new dataset, available in <a href="https://sql.telemetry.mozilla.org">Re:dash</a>.
The best documentation we have for the Parquet schema is by looking at the examples in
<a href="https://github.com/mozilla-services/mozilla-pipeline-schemas"><code>mozilla-pipeline-schemas</code></a>.</p>
<p>Parquet output also has a <code>metadata</code> section. These are fields added to the ping at ingestion time;
they might come from the URL submitted to the edge server, or the IP Address used to make the request.
<a href="https://pipeline-cep.prod.mozaws.net/dashboard_output/analysis.moz_telemetry_parquet_schema.parquet.txt">This document</a>
lists available metadata fields for all pings.</p>
<p>The stream you're interested in is probably <code>telemetry</code>.
For example, look at <code>system-addon-deployment-diagnostics</code> immediately under the <code>telemetry</code> top-level
field. The <code>schema</code> element has top-level fields (e.g. <code>Timestamp</code>, <code>Type</code>), as well as more fields
under the <code>Fields</code> element. Any of these can be used in the <code>metadata</code> section of your parquet schema,
except for <code>submission</code>.</p>
<p>Some common ones for Telemetry data might be:</p>
<ul>
<li><code>Date</code></li>
<li><code>submissionDate</code></li>
<li><code>geoCountry</code></li>
<li><code>geoCity</code></li>
<li><code>geoSubdivision1</code></li>
<li><code>geoSubdivision2</code></li>
<li><code>normalizedChannel</code></li>
<li><code>appVersion</code></li>
<li><code>appBuildId</code></li>
</ul>
<p>And for non-Telemetry data:</p>
<ul>
<li><code>geoCountry</code></li>
<li><code>geoCity</code></li>
<li><code>geoSubdivision1</code></li>
<li><code>geoSubdivision2</code></li>
<li><code>documentId</code></li>
</ul>
<p><em>Important Note</em>: Schema evolution of nested structs is currently broken, so you will not be able to add
any fields in the future to your <code>metadata</code> section. We recommend adding any that may seem useful.</p>
<h3><a class="header" href="#testing-the-schema" id="testing-the-schema">Testing The Schema</a></h3>
<p>For new data, use the <a href="https://github.com/mozilla-services/edge-validator">edge validator</a> to test
your schema.</p>
<p>If your data is <em>already</em> being sent, and you want to test the schema you're writing on the data
that is currently being ingested, you can test your Parquet output in
<a href="https://pipeline-cep.prod.mozaws.net/">Hindsight</a> by using an output plugin.
See <a href="https://bugzilla.mozilla.org/attachment.cgi?id=8829626">Core ping output plugin</a>
for an example, where the parquet schema is specified as <code>parquet_schema</code>. If no errors arise, that
means it should be correct. The &quot;Deploy&quot; button should not be used to actually deploy, that will be
done by operations in the next step.</p>
<h2><a class="header" href="#telemetry-specific-deploy-the-plugin" id="telemetry-specific-deploy-the-plugin">(Telemetry-specific) Deploy the Plugin</a></h2>
<p>File <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1333203">a bug to deploy the new schema.</a></p>
<p>Real-time analysis will be key to ensuring your data is being processed and parsed correctly.
It should follow the format specified in
<a href="https://mozilla-services.github.io/lua_sandbox_extensions/moz_telemetry/sandboxes/heka/analysis/moz_telemetry_doctype_monitor.html">MozTelemetry <code>docType</code> monitor</a>.
This allows you to check validation errors, size changes, duplicates, and more. Once you have
the numbers set, file a
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1356380">bug to let ops deploy it</a>.</p>
<h2><a class="header" href="#start-sending-data" id="start-sending-data">Start Sending Data</a></h2>
<p>If you're using the Telemetry APIs, use those built-in. These can be with the
<a href="https://firefox-source-docs.mozilla.org/toolkit/components/telemetry/telemetry/collection/custom-pings.html">Gecko Telemetry APIs</a>,
the <a href="https://github.com/mozilla-mobile/telemetry-android">Android Telemetry APIs</a>, or the
<a href="https://github.com/mozilla-mobile/telemetry-ios">iOS Telemetry APIs</a>.</p>
<p>For non-Telemetry data, see <a href="../concepts/pipeline/http_edge_spec.html">our HTTP edge server specification</a>
and specifically the <a href="../concepts/pipeline/http_edge_spec.html#postput-request">non-Telemetry example</a> for the expected format. The edge
server endpoint is <code>https://incoming.telemetry.mozilla.org</code>.</p>
<h2><a class="header" href="#non-telemetry-access-your-data" id="non-telemetry-access-your-data">(Non-Telemetry) Access Your Data</a></h2>
<p>First confirm with the reviewers of
<a href="#submit-schema-to-mozilla-servicesmozilla-pipeline-schemas">your schema pull request</a>
that your schemas have been deployed.</p>
<p>In the following links, replace <code>&lt;namespace&gt;</code>, <code>&lt;doctype&gt;</code> And <code>&lt;docversion&gt;</code> with
appropriate values. Also replace <code>-</code> with <code>_</code> in <code>&lt;namespace&gt;</code> if your
namespace contains <code>-</code> characters.</p>
<h3><a class="header" href="#cep" id="cep">CEP</a></h3>
<p>Once you've sent some pings, refer to the following real-time analysis plugins
to verify that your data is being processed:</p>
<ul>
<li><code>https://pipeline-cep.prod.mozaws.net/dashboard_output/graphs/analysis.moz_generic_error_monitor.&lt;namespace&gt;.html</code></li>
<li><code>https://pipeline-cep.prod.mozaws.net/dashboard_output/analysis.moz_generic_&lt;namespace&gt;_&lt;doctype&gt;_&lt;docversion&gt;.submissions.json</code></li>
<li><code>https://pipeline-cep.prod.mozaws.net/dashboard_output/analysis.moz_generic_&lt;namespace&gt;_&lt;doctype&gt;_&lt;docversion&gt;.errors.txt</code></li>
</ul>
<p>If this first graph shows ingestion errors, you can view the corresponding
error messages in the third link. Otherwise, you should be able to view the
last ten processed submissions via the second link. You can also write your own
custom real-time analysis plugins using this same infrastructure if you desire;
use the above plugins as examples and see
<a href="realtime_analysis_plugin.html">here</a> for a more detailed explanation.</p>
<p>If you encounter schema validation errors, you can fix your data or
<a href="#submit-schema-to-mozilla-servicesmozilla-pipeline-schemas">submit another pull request</a>
to amend your schemas. Backwards-incompatible schema changes should generally
be accompanied by an increment to <code>docversion</code>.</p>
<p>Once you've established that your pings are flowing through the real-time
system, verify that you can access the data from the downstream systems.</p>
<h3><a class="header" href="#stmo" id="stmo">STMO</a></h3>
<p>In the Athena data source, a new table
<code>&lt;namespace&gt;_&lt;doctype&gt;_parquet_&lt;docversion&gt;</code> will be created for your data. A
convenience pointer <code>&lt;namespace&gt;_&lt;doctype&gt;_parquet</code> will also refer to the latest
available <code>docversion</code> of the ping. The data is partitioned by
<code>submission_date_s3</code> which is formatted as <code>%Y%m%d</code>, like <code>20180130</code>, and is
generally updated hourly. Refer to the <a href="../tools/stmo.html">STMO documentation</a>
for general information about using Re:dash.</p>
<p>This table may take up to a day to appear in the Athena source; if you still
don't see a table for your new ping after 24 hours,
<a href="https://mana.mozilla.org/wiki/display/SVCOPS/Contacting+Data+Operations">contact Data Operations</a>
so that they can investigate. Once the table is available, it should contain
all the pings sent during that first day, regardless of how long it takes for
the table to appear.</p>
<h3><a class="header" href="#spark" id="spark">Spark</a></h3>
<p>The data should be available in S3 at:</p>
<p><code>s3://net-mozaws-prod-us-west-2-pipeline-data/&lt;namespace&gt;-&lt;doctype&gt;-parquet/v&lt;docversion&gt;/</code></p>
<p>Note: here <code>&lt;namespace&gt;</code> should not be escaped.</p>
<p>Refer to the <a href="../tools/spark.html#faq">Spark FAQ</a> for details on accessing this table via Spark.</p>
<h2><a class="header" href="#write-etl-jobs" id="write-etl-jobs">Write ETL Jobs</a></h2>
<p>We have some basic generalized ETL jobs you can use to transform your data on a batch basis - for example,
a <a href="https://github.com/mozilla/telemetry-batch-view/blob/master/src/main/scala/com/mozilla/telemetry/views/GenericLongitudinal.scala">Longitudinal</a>
or <a href="https://github.com/mozilla/telemetry-batch-view/blob/master/src/main/scala/com/mozilla/telemetry/views/GenericCountView.scala">client-count-daily</a>
like dataset. Otherwise, you'll have to write your own.</p>
<h2><a class="header" href="#build-dashboards-using-spark-or-stmo" id="build-dashboards-using-spark-or-stmo">Build Dashboards Using Spark or STMO</a></h2>
<p>Last steps! What are you using this data for anyway?</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../cookbooks/bigquery.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../cookbooks/client_guidelines.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="../cookbooks/bigquery.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="../cookbooks/client_guidelines.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        <script type="text/javascript" src="../mermaid.min.js"></script>
        
        <script type="text/javascript" src="../mermaid-init.js"></script>
        

        

    </body>
</html>
